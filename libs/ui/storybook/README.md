# Storybook for UI Libraries

This library was generated with [Nx](https://nx.dev). 
It serves a placeholder to be able to use NX schematics to generate a default 
storybook config which we then adjust to include all stories in the ```ui``` folder 
and be the home of our tailwind config.

## Including all stories

The magic happens in the ```.storybook/main.ts``` folder.
We change the stories property to include all stories in all 
folders that are part of the ```ui``` folder.

```ts
  stories: [
    ...rootMain.stories,
    // go up two folders from .storybook --> storybook --> ui and 
    // include all files that match the below format
    '../../**/*.stories.mdx',
    '../../**/*.stories.@(js|jsx|ts|tsx)',
  ]
```

## Making tailwind work

In order to make tailwind work for our storybook project we need two things to happen:
1. We correctly scan all ui projects for tailwind classes
2. We import the necessary tailwind css utilities into our storybook build processes

### 1. Adding tailwind.config.js

We copy the autogenerated tailwind.config.js file from our example app, 
which was generated by the NX schematic. We then adjust it to scan all
libraries in the ui folder for tailwind classes. The important part here is:

```js
  content: [
    // go up one folder and scan all files for tw classes that are not stories or test files
    join(__dirname, '../**/!(*.stories|*.spec).{ts,html}'),
    ...createGlobPatternsForDependencies(__dirname),
  ]
```

### 2. Adding styles.css with tailwind utilities

In order to include the css utilities that make tailwind work we 
need to copy the styles.css file that includes them  from our example app,
which was generated by the NX schematic. We then need to include this file into the styles array of our 
```storybook``` and ```build-storybook``` targets in our ```project.json``` file.

```json
{
  ...
  "targets": {
    ...
    "storybook": {
      ...
      "options":   {
        ...
        "styles": [
          "libs/ui/storybook/styles.css"
        ]
      }
    },
    "build-storybook": {
      ...
      "options":   {
        ...
        "styles": [
          "libs/ui/storybook/styles.css"
        ]
      }
    }
  }
}
```
